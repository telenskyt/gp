<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Construct covariance matrix (K) for given data and hyperparameters — K_matrix • gp</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Construct covariance matrix (K) for given data and hyperparameters — K_matrix"><meta property="og:description" content="This function is mostly used internally. In most common use, user will call gpFit() or predict(), which call this function themselves."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/a-simple-example.html">A simple example</a>
    </li>
    <li>
      <a href="../articles/pok.html">pok</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Construct covariance matrix (K) for given data and hyperparameters</h1>

    <div class="hidden name"><code>K_matrix.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is mostly used internally. In most common use, user will call gpFit() or predict(), which call this function themselves.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">K_matrix</span><span class="op">(</span></span>
<span>  <span class="va">gp</span>,</span>
<span>  hyperpar <span class="op">=</span> <span class="fu"><a href="gpHyperparList.html">gpHyperparList</a></span><span class="op">(</span><span class="va">gp</span><span class="op">)</span>,</span>
<span>  x1 <span class="op">=</span> <span class="va">gp</span><span class="op">$</span><span class="va">data</span>,</span>
<span>  x2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  K.cache <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  components <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  comp_means <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  comp_means_weights <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-gp">gp<a class="anchor" aria-label="anchor" href="#arg-gp"></a></dt>
<dd><p>object of class <code>gp</code>.</p></dd>


<dt id="arg-hyperpar">hyperpar<a class="anchor" aria-label="anchor" href="#arg-hyperpar"></a></dt>
<dd><p>(optional) lists of hyperparameter values, as returned by <code><a href="gpHyperparList.html">gpHyperparList()</a></code>; default is to use the hyperparameters from the <code>gp</code> object.</p></dd>


<dt id="arg-x-">x1<a class="anchor" aria-label="anchor" href="#arg-x-"></a></dt>
<dd><p>object of class <code>gpData</code> - data corresponding to rows of the resultant covariance matrix.
It is supposed to be correctly scaled already! (see <code>gpDataPrepare()</code>)</p></dd>


<dt id="arg-x-">x2<a class="anchor" aria-label="anchor" href="#arg-x-"></a></dt>
<dd><p>(optional) object of class <code>gpData</code> - data corresponding to columns of the resultant covariance matrix.
If not supplied, <code>x1</code> is used and
the covariance matrix is square and symmetric.
It is supposed to be correctly scaled already! (see <code>gpDataPrepare()</code>)</p></dd>


<dt id="arg-k-cache">K.cache<a class="anchor" aria-label="anchor" href="#arg-k-cache"></a></dt>
<dd><p>(optional) object returned by <code>K_cache()</code> function, to speed up repeated calls to <code>K_matrix()</code> and <code>dK_dhi()</code> functions.</p></dd>


<dt id="arg-components">components<a class="anchor" aria-label="anchor" href="#arg-components"></a></dt>
<dd><p>of the covariance formula. One of the following:</p><ul><li><p>NULL : all components will be selected (the default)</p></li>
<li><p>character vector: components to be selected</p></li>
<li><p>formula: additive formula specifying components, same syntax as in <a href="https://rdrr.io/r/stats/update.formula.html" class="external-link">update.formula</a>, e.g.</p><table class="table table"><tr><td><code>~.</code>          <code>   </code></td><td>all components</td></tr><tr><td><code>~.-env-spat</code> <code>   </code></td><td>all components except <code>env</code> and <code>spat</code></td></tr><tr><td><code>~spat+year</code>  <code>   </code></td><td>only components <code>spat</code> and <code>year</code></td></tr></table></li>
</ul></dd>


<dt id="arg-comp-means">comp_means<a class="anchor" aria-label="anchor" href="#arg-comp-means"></a></dt>
<dd><p>only meaningful for <code>x1</code> being the training dataset and <code>x2 = NULL</code>. If set to TRUE, then for each component, calculate vector of covariances
of the training data with the average of all the predictions from the training dataset, for that particular component. These vectors are
the rowmeans of training covariance matrices (that's why called component means). Save them in an attribute <code>comp_means</code> of K. These are later used
in the <code>predict</code> method.</p>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>For comp_means <span class="ot">=</span> <span class="cn">TRUE</span>, x1 should be the training dataset. Perhaps it might make sense <span class="cf">in</span> other cases as well, but just make sure you know what you<span class="st">'re doing :)</span></span></code></pre><p></p></div></dd>


<dt id="arg-comp-means-weights">comp_means_weights<a class="anchor" aria-label="anchor" href="#arg-comp-means-weights"></a></dt>
<dd><ul><li><p>don't have to sum up to 1, will be normalized</p></li>
</ul></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Covariance matrix K:</p><ul><li><p>Number of rows will be equal to <code>gpDataSize(x1, gp$GP_factor)</code>, where <code>gp$GP_factor</code> is the grouping factor corresponding to the dimension of the Gaussian process.</p></li>
<li><p>Analogically, if <code>x2</code> is supplied, the number of columns will be equal to <code>gpDataSize(x2, gp$GP_factor)</code>.</p></li>
<li><p>If <code>x2</code> is not supplied, the covariance matrix is square and symmetric, representing the covariances among all rows in <code>x1</code>.</p></li>
</ul></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tomáš Telenský.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

