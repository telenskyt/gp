<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Predict from a fitted Gaussian process model — predict.gp • gp</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Predict from a fitted Gaussian process model — predict.gp"><meta property="og:description" content="Predict from a fitted Gaussian process model. Predictions are done at the level of the Gaussian Process, i.e. along the factor specified by gp$GP_factor."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/a-simple-example.html">A simple example</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/telenskyt/gp/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Predict from a fitted Gaussian process model</h1>
    <small class="dont-index">Source: <a href="https://github.com/telenskyt/gp/blob/HEAD/R/predict.gp.R" class="external-link"><code>R/predict.gp.R</code></a></small>
    <div class="hidden name"><code>predict.gp.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Predict from a fitted Gaussian process model. Predictions are done at the level of the Gaussian Process, i.e. along the factor specified by <code>gp$GP_factor</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'gp'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>  <span class="va">gp</span>,</span>
<span>  newdata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hyperpar <span class="op">=</span> <span class="fu"><a href="gpHyperparList.html">gpHyperparList</a></span><span class="op">(</span><span class="va">gp</span><span class="op">)</span>,</span>
<span>  components <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  comp_missing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"avg"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  w <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  groupMeans <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"latent"</span>, <span class="st">"response"</span><span class="op">)</span>,</span>
<span>  se.fit <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cov.fit <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  CI <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  link <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parname <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  maxn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pred.sims <span class="op">=</span> <span class="fl">1e+05</span>,</span>
<span>  Kx.cache <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  Kxx.cache <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-gp">gp<a class="anchor" aria-label="anchor" href="#arg-gp"></a></dt>
<dd><p>object of class gp, the fitted Gaussian process model</p></dd>


<dt id="arg-newdata">newdata<a class="anchor" aria-label="anchor" href="#arg-newdata"></a></dt>
<dd><p>object of class gpData, <em><strong>unscaled</strong></em> (i.e. not passed through <code>gpDataPrepare()</code>) data! They must be on the same scale as
the unscaled training dataset used for fitting the model. If <code>NULL</code> (the default), predictions will be made on the training dataset (which
is going to be super fast if CI = NULL)</p></dd>


<dt id="arg-hyperpar">hyperpar<a class="anchor" aria-label="anchor" href="#arg-hyperpar"></a></dt>
<dd><p>(optional) lists of hyperparameter values, as returned by <code><a href="gpHyperparList.html">gpHyperparList()</a></code>; default is to use the hyperparameters from the <code>gp</code> object.</p></dd>


<dt id="arg-components">components<a class="anchor" aria-label="anchor" href="#arg-components"></a></dt>
<dd><p>of the covariance formula. One of the following:</p><ul><li><p>NULL : all components will be selected (the default)</p></li>
<li><p>character vector: components to be selected</p></li>
<li><p>formula: additive formula specifying components, same syntax as in <a href="https://rdrr.io/r/stats/update.formula.html" class="external-link">update.formula</a>, e.g.</p><table class="table table"><tr><td><code>~.</code>          <code>   </code></td><td>all components</td></tr><tr><td><code>~.-env-spat</code> <code>   </code></td><td>all components except <code>env</code> and <code>spat</code></td></tr><tr><td><code>~spat+year</code>  <code>   </code></td><td>only components <code>spat</code> and <code>year</code></td></tr></table></li>
</ul></dd>


<dt id="arg-comp-missing">comp_missing<a class="anchor" aria-label="anchor" href="#arg-comp-missing"></a></dt>
<dd><p>how to compensate for missing components (if there are any), in mean and variance of the predictions:</p><dl><dt><code>"none"</code></dt>
<dd><p>no compensation. In this case, the interpretation of the result's variance isn't much clear (!!!??? why?).</p></dd>

<dt><code>"avg"</code></dt>
<dd><p>the missing components are replaced by "averaging over them" - more
precisely, it predicts for the average effects of these components - for these, the variance/CI corresponds to confidence interval
(uncertainty around the mean predictions) and not the prediction interval - see http://www.sthda.com/english/articles/40-regression-analysis/166-predict-in-r-model-predictions-and-confidence-intervals/
For models which have grouping factors, be aware of how the average is weighted - see CAUTION CAU001 in the code.</p></dd>


</dl><p>Thus, the most reasonable setting now is <code>"avg"</code>; unless one cares only about the prediction mean (<code>f</code>) of the latent variable, in which case
a simple "none" would also do the job.</p></dd>


<dt id="arg-w">w<a class="anchor" aria-label="anchor" href="#arg-w"></a></dt>
<dd><p>providing this optional argument will calculate average prediction(s) of all data points in this dataset, given these weights. Can
be either a vector of the same length as the size of <code>newdata</code> (in which case a single average is calculated), or,
if more different averages with different weights are desired, <code>w</code> can be a matrix where each column corresponds to one average - one set of weights
(i.e. number of rows of <code>w</code> must be equal to the size of <code>newdata</code>, number of columns equal to the number of different averages to be calculated).</p></dd>


<dt id="arg-groupmeans">groupMeans<a class="anchor" aria-label="anchor" href="#arg-groupmeans"></a></dt>
<dd><p>optional, factor of the size of the predicted dataset. If provided, mean predictions for each factor level are calculated.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>character; type of prediction:</p><dl><dt><code>"response"</code></dt>
<dd><p>(default) - predictions on the response scale</p></dd>

<dt><code>"latent"</code></dt>
<dd><p>predictions on the latent scale</p></dd>


</dl></dd>


<dt id="arg-cov-fit">cov.fit<a class="anchor" aria-label="anchor" href="#arg-cov-fit"></a></dt>
<dd><p>logical; if <code>TRUE</code>, the covariance matrix of the predictions will also be returned (can be very memory consuming for large datasets!).
Default is <code>FALSE</code>.</p></dd>


<dt id="arg-link">link<a class="anchor" aria-label="anchor" href="#arg-link"></a></dt>
<dd><p>character, optional. In case of <code>type = "response"</code>, what should be the link function to take inverse of for calculating the derived quantity (response scale)? Character as passed to <code><a href="https://rdrr.io/r/stats/make.link.html" class="external-link">make.link()</a></code>.</p></dd>


<dt id="arg-parname">parname<a class="anchor" aria-label="anchor" href="#arg-parname"></a></dt>
<dd><p>character, optional. In case of <code>type = "response"</code>, what should be the name of the parameter which is the derived quantity on the response scale?</p></dd>


<dt id="arg-maxn">maxn<a class="anchor" aria-label="anchor" href="#arg-maxn"></a></dt>
<dd><p>maximum maximum dataset size to fit at once (!!! the unit ???!!!); if the dataset is larger, it will be split into chunks of size <code>maxn</code>
before predictions are calculated. This parameter doesn't affect the result. It is only to speed-up the computation and use less memory by splitting the dataset</p><ul><li><p>the K(newdata,newdata) matrix is then smaller. So it only speeds it up for CI != NULL (in the backsolve function) for CI = NULL its only slowdown.</p></li>
</ul></dd>


<dt id="arg-pred-sims">pred.sims<a class="anchor" aria-label="anchor" href="#arg-pred-sims"></a></dt>
<dd><p>(currently unused) number of simulations to be used for calculating the response scale predictions and their CIs. Default is 100000.
Higher values give more accurate results, but are slower. Ignored if <code>CI = NULL</code>.</p></dd>


<dt id="arg-kx-cache">Kx.cache<a class="anchor" aria-label="anchor" href="#arg-kx-cache"></a></dt>
<dd><p>optional, object returned by <code>K_cache()</code> function, to speed up repeated calls to <code>predict.gp()</code> with the same <code>newdata</code> by
caching parts of the K(training_data, newdata) matrix.</p></dd>


<dt id="arg-kxx-cache">Kxx.cache<a class="anchor" aria-label="anchor" href="#arg-kxx-cache"></a></dt>
<dd><p>optional, object returned by <code>K_cache()</code> function, to speed up repeated calls to <code>predict.gp()</code> with the same <code>newdata</code> by
caching parts of the K(newdata, newdata) matrix.</p></dd>


<dt id="arg--">!!!!!!<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>upravit po nove definici - mozna udelat default NULL? CI numeric between 0 and 1, or <code>NULL</code>; confidence level for the confidence intervals to be calculated. If <code>NULL</code>, no standard errors
and confidence intervals will be calculated, which makes the prediction much faster (but then also no mean on the response scale will be
calculated - because for this, the standard error of the latent GP <code>f</code> is needed.)). Default is 0.95.</p></dd>

</dl></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tomáš Telenský.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

