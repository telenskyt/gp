<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fit a Gaussian process model — gpFit • gp</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fit a Gaussian process model — gpFit"><meta property="og:description" content="Fit a Gaussian process model"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/pok.html">pok</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit a Gaussian process model</h1>

    <div class="hidden name"><code>gpFit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fit a Gaussian process model</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gpFit</span><span class="op">(</span></span>
<span>  <span class="va">gp</span>,</span>
<span>  h <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  opt.h <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  two.stage <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  stages <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,</span>
<span>  stage1low <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  use.prior <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  hessian <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  opt.control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>factr <span class="op">=</span> <span class="fl">1e+10</span>, maxit <span class="op">=</span> <span class="fl">190</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Laplace"</span><span class="op">)</span>,</span>
<span>  use_f_start <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  grad.computation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  warn.exclude <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  recursive <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-gp">gp<a class="anchor" aria-label="anchor" href="#arg-gp"></a></dt>
<dd><p>GP model object.</p></dd>


<dt id="arg-h">h<a class="anchor" aria-label="anchor" href="#arg-h"></a></dt>
<dd><p>optional; a numeric vector of starting values of hyperparameters (untransformed, i.e. on their most natural scale). If <code>NULL</code>,
the starting values are taken from <code>gp</code> hyperparameter table (<code>gp$hyperpar[,"start"]</code>).</p></dd>


<dt id="arg-opt-h">opt.h<a class="anchor" aria-label="anchor" href="#arg-opt-h"></a></dt>
<dd><p>logical; should hyperparameters be optimised? Default TRUE; Only rarely you may want to say FALSE.</p></dd>


<dt id="arg-two-stage">two.stage<a class="anchor" aria-label="anchor" href="#arg-two-stage"></a></dt>
<dd><p>logical; if TRUE (the default), the two-stage optimization method will be applied (see Details below).</p></dd>


<dt id="arg-stages">stages<a class="anchor" aria-label="anchor" href="#arg-stages"></a></dt>
<dd><p>numerical vector - the optimization stages to be performed. Only relevant for <code>two.stage = TRUE</code>. Default is <code>1:2</code>, i.e. both stages.
See details below.</p>
<p>If you are running only stage 2 separately, which would make sense only in rare cases (perhaps <code>two.stage = FALSE</code> is what you need in most of those cases),
note that stage 2 doesn't start from <code>gp$hyperpar$start</code>, but from <code>gp$hyperpar$value</code>.</p></dd>


<dt id="arg-stage-low">stage1low<a class="anchor" aria-label="anchor" href="#arg-stage-low"></a></dt>
<dd><p>the low threshold for the sigma2 parameter of the components for which the two-stage fitting applies.</p></dd>


<dt id="arg-use-prior">use.prior<a class="anchor" aria-label="anchor" href="#arg-use-prior"></a></dt>
<dd><p>logical; if TRUE, likelihood + prior (posterior) is optimized; if FALSE, only likelihood is optimized.</p></dd>


<dt id="arg-hessian">hessian<a class="anchor" aria-label="anchor" href="#arg-hessian"></a></dt>
<dd><p>logical; compute and return the Hessian during the optimization. Warning: may be heavy on CPU time! Default FALSE.</p></dd>


<dt id="arg-opt-control">opt.control<a class="anchor" aria-label="anchor" href="#arg-opt-control"></a></dt>
<dd><p>list of control parameters passed to the <code>optim(control = )</code></p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>logical</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>character; fitting method. Currently <code>"Laplace"</code> supported (Laplace approximation).</p></dd>


<dt id="arg-use-f-start">use_f_start<a class="anchor" aria-label="anchor" href="#arg-use-f-start"></a></dt>
<dd><p>logical; internal optimization - start each Laplace approximation from the optimized <code>f</code> vector from the previous hyperparameter iteration.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>numeric or <code>NULL</code>; observation weights (not implemented).</p></dd>


<dt id="arg-grad-computation">grad.computation<a class="anchor" aria-label="anchor" href="#arg-grad-computation"></a></dt>
<dd><p>logical; compute gradients during the gaussian process optimization (required when
<code>opt.h = TRUE</code>).</p></dd>


<dt id="arg-warn-exclude">warn.exclude<a class="anchor" aria-label="anchor" href="#arg-warn-exclude"></a></dt>
<dd><p>character vector; vector of warnings that should be disabled. Allowed values are: <code>"warn.stage2.start"</code>. Default <code>NULL</code>.</p></dd>


<dt id="arg-recursive">recursive<a class="anchor" aria-label="anchor" href="#arg-recursive"></a></dt>
<dd><p>internal option; do not use.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Returns the input <code>gp</code> object with the model fit (stored in <code>gp$fit</code>) and updated hyperparameters.</p>
<p><em>NOTE!!</em> The returned object is usually large, because it contains pre-calculated matrices that are used for predictions. If you need to save the model,
call <code><a href="gpPack.html">gpPack()</a></code> first to remove these; when you need to use the model again, call <code><a href="gpUnpack.html">gpUnpack()</a></code> to restore these matrices.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The two-stage fitting method (<code>two.stage = TRUE</code>) is a special optimization procedure (Telenský et al 2026) where the optimization is split into two stages:</p><ol><li><p>In the first stage, sigma2 parameters are not allowed to go too close to zero (as per the <code>stage1low</code> parameter). This way, the other hyper-parameters in the same component have time
to optimize themselves before the sigma2 parameter could shut the whole component down to zero. (This is only applied to components
that have also other hyper-parameters apart from sigma2.)</p></li>
<li><p>In the second stage, the restriction applied in the first stage is lifted and all the sigma2 hyper-parameters are allowed to go further down to zero.</p></li>
</ol><p>In some cases, where user tries to optimize the CPU time by manually splitting the procedure in multiple steps, it might be a good idea to run both stages only in the last step,
and use only stage 1 in all the previous steps (see Vignette XXX).</p>
<p>If you are running only stage 2 separately, which would make sense only in rare cases (perhaps <code>two.stage = FALSE</code> is what you need in most of those cases),
note that stage 2 doesn't start from <code>gp$hyperpar$start</code>, but from <code>gp$hyperpar$value</code>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">gp</span> <span class="op">&lt;-</span> <span class="fu"><a href="gp.html">gp</a></span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="co"># construct gp object</span></span></span>
<span class="r-in"><span><span class="va">gp</span> <span class="op">&lt;-</span> <span class="fu">gpFit</span><span class="op">(</span><span class="va">gp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Tomáš Telenský.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

